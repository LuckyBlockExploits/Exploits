task.wait(3)

local waitTime = 0.1 -- the speed you will teleport in between gifts and buttons. 
local teleportButtonsToYou = true -- if false, you will teleport to the buttons instead.

--[variable initilizations]--
local houseFarming = false
local giftFarming = false
local rebirthFarming = false
local plotNumber = tostring("Plot "..game.Players.LocalPlayer.PlotNumber.Value)
--[end]--



local buttons = {}
local function getCheapestButton()
	table.clear(buttons)
	for i,v in pairs(game.Workspace:GetDescendants()) do 
		if v.Name == plotNumber then
			for x, m in pairs(v:GetDescendants()) do
				if m.Name == "PriceCounter" then
					table.insert(buttons, {tonumber(string.sub(m.Text,2)), m.Parent.Parent.Parent})
					table.sort(buttons, function(a, b)
						return a[1] < b[1]
					end)
				end
			end
		end
	end
	return (buttons[1][2])
end




local function fireproximityprompt(ProximityPrompt, Amount, Skip)
	assert(ProximityPrompt, "Argument #1 Missing or nil")
	assert(typeof(ProximityPrompt) == "Instance" and ProximityPrompt:IsA("ProximityPrompt"), "Attempted to fire a Value that is not a ProximityPrompt")

	local HoldDuration = ProximityPrompt.HoldDuration
	if Skip then
		ProximityPrompt.HoldDuration = 0
	end

	for i = 1, Amount or 1 do
		ProximityPrompt:InputHoldBegin()
		if Skip then
			local RunService = game:GetService("RunService")
			local Start = time()
			repeat
				RunService.Heartbeat:Wait(0.1)
			until time() - Start > HoldDuration
		end
		ProximityPrompt:InputHoldEnd()
	end
	ProximityPrompt.HoldDuration = HoldDuration
end




--[GUI CREATION]--
local function randomString(length)
	local str = ""
	for i = 1, length do
		local chars = "1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ"
		local rint = math.random(1, #chars) 
		local rchar = chars:sub(rint, rint)
		str = str..rchar
	end
	return str
end

local sellPad = game.Workspace.Cabins[plotNumber].MoneyButton.Collision
local screenGuiName = randomString(10)
local autoButtonName = randomString(10)
local autoFrameName = randomString(10)

local screenGui = Instance.new("ScreenGui")
screenGui.Name = screenGuiName
screenGui.Parent = game.Players.LocalPlayer.PlayerGui

local title = (game:GetService("Players").LocalPlayer.PlayerGui.ScreenGui.SettingsMenu.MenuTitle):Clone()

local autofarmFrame = (game:GetService("Players").LocalPlayer.PlayerGui.ScreenGui.SettingsMenu):Clone()

local autofarmButton = (game:GetService("Players").LocalPlayer.PlayerGui.ScreenGui.Buttons.SettingsButton):Clone()

autofarmButton.Parent = game:GetService("Players").LocalPlayer.PlayerGui[screenGuiName]
autofarmButton.Name = autoButtonName
autofarmButton.ButtonLabel.Text = "Autofarm"
autofarmButton.ButtonIcon.ImageColor3 = Color3.new(1,0,0)
autofarmButton.BackgroundColor3 = Color3.new(1,0,0)
autofarmButton.Position = UDim2.new(0.07,0,0.83,0)
autofarmButton.Size = UDim2.new(0.13,0,0.075,0)

autofarmFrame.Parent = game:GetService("Players").LocalPlayer.PlayerGui[screenGuiName]
autofarmFrame.Name = autoFrameName
autofarmFrame.SizeConstraint = "RelativeYY"
autofarmFrame.MenuTitle.Text = "Autofarm"
autofarmFrame.MusicSetting.SettingName.Text = "Auto Houses"
autofarmFrame.GuiSFXSetting.SettingName.Text = "Auto Gifts"
autofarmFrame.SFXSetting.SettingName.Text = "Auto Rebirth"
autofarmFrame.ResetButton.ButtonText.Text = "Destroy GUI"
autofarmFrame.ResetButton.ButtonText.TextColor3 = Color3.new(1,1,0)
autofarmFrame.SettingsMenuScript:Destroy()

title.Parent = autofarmFrame
title.Position = UDim2.new(0, 0, 0.15, 0)
title.Text = ""
title.Name = "Note"


--[GUI CREATION] (IT IS OVER)--


--[GUI FUNCTIONS]--
autofarmButton.mouseButton1Down:Connect(function()
	if teleportButtonsToYou == false then
		title.Text = "teleportButtonsToYou = false: \n Gift farming won't work when enabled with house farming."
	else
		title.Text = "teleportButtonsToYou = true: \n May cause lag when farming houses"
	end
	if autofarmFrame.Visible == false then
		autofarmFrame.Visible = true
	else
		autofarmFrame.Visible = false
	end
end)


local rebirthToggle = autofarmFrame.SFXSetting.ToggleFrame
local giftToggle = autofarmFrame.GuiSFXSetting.ToggleFrame
local houseToggle = autofarmFrame.MusicSetting.ToggleFrame

if rebirthFarming == false then
	rebirthToggle.StatusIndicator.BackgroundColor3 = Color3.new(1,0,0)
	rebirthToggle.StatusIndicator.Position = UDim2.new(0.3,0,0.5,0)
end

if giftFarming == false then
	giftToggle.StatusIndicator.BackgroundColor3 = Color3.new(1,0,0)
	giftToggle.StatusIndicator.Position = UDim2.new(0.3,0,0.5,0)
end

if houseFarming == false then
	houseToggle.StatusIndicator.BackgroundColor3 = Color3.new(1,0,0)
	houseToggle.StatusIndicator.Position = UDim2.new(0.3,0,0.5,0)
end


rebirthToggle.mouseButton1Down:Connect(function()
	if rebirthFarming == false then
		rebirthFarming = true
		rebirthToggle.StatusIndicator.BackgroundColor3 = Color3.new(63/255, 229/255, 54/255)
		rebirthToggle.StatusIndicator.Position = UDim2.new(0.8,0,0.5,0)
		while rebirthFarming == true do
			wait(waitTime)
			local A_1 = game:GetService("Players").LocalPlayer
			local Event = game:GetService("ReplicatedStorage").RebirthRequest
			Event:InvokeServer(A_1)
		end
	else 
		if rebirthFarming == true then
			rebirthFarming = false
			rebirthToggle.StatusIndicator.BackgroundColor3 = Color3.new(1,0,0)
			rebirthToggle.StatusIndicator.Position = UDim2.new(0.3,0,0.5,0)
		end
	end
end)


giftToggle.mouseButton1Down:Connect(function()
	if giftFarming == false then
		giftFarming = true
		giftToggle.StatusIndicator.BackgroundColor3 = Color3.new(63/255, 229/255, 54/255)
		giftToggle.StatusIndicator.Position = UDim2.new(0.8,0,0.5,0)
		while giftFarming == true do
			wait(waitTime)
			for i, v in ipairs(game.Workspace:GetDescendants()) do
				if v.Name == "Present" and v.Box.Wrapper.Transparency ~= 1 then
					game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(v.Collide.Position)
					fireproximityprompt(v.Collide.ProximityPrompt)
				end
			end
		end
	else 
		if giftFarming == true then
			giftFarming = false
			giftToggle.StatusIndicator.BackgroundColor3 = Color3.new(1,0,0)
			giftToggle.StatusIndicator.Position = UDim2.new(0.3,0,0.5,0)
		end
	end
end)

local buttons = {}


houseToggle.mouseButton1Down:Connect(function()
	if houseFarming == false then
		houseFarming = true
		houseToggle.StatusIndicator.BackgroundColor3 = Color3.new(63/255, 229/255, 54/255)
		houseToggle.StatusIndicator.Position = UDim2.new(0.8,0,0.5,0)
		while houseFarming == true do
			wait(waitTime)
			if teleportButtonsToYou == false then
				sellPad.CFrame = game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame
				game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(getCheapestButton().Collision.Position)
				sellPad.BillboardGui.Enabled = false
				for i, v in pairs(game.Workspace:GetDescendants()) do
					if v.Name == "Seat" then
						v:Destroy()
					end
				end
			elseif teleportButtonsToYou == true then
				sellPad.CFrame = game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame
				getCheapestButton().Collision.CFrame = CFrame.new(game.Players.LocalPlayer.Character.HumanoidRootPart.Position)
				sellPad.BillboardGui.Enabled = false
			end
		end
	else 
		if houseFarming == true then
			houseFarming = false
			houseToggle.StatusIndicator.BackgroundColor3 = Color3.new(1,0,0)
			houseToggle.StatusIndicator.Position = UDim2.new(0.3,0,0.5,0)
		end
	end
end)


autofarmFrame.ResetButton.mouseButton1Down:Connect(function()
	autofarmFrame:Destroy()
	autofarmButton:Destroy()
	screenGui:Destroy()
end)
